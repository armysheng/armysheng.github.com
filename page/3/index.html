<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="blog, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="Nothing much yet">
<meta property="og:type" content="website">
<meta property="og:title" content="Eric&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Eric&#39;s Blog">
<meta property="og:description" content="Nothing much yet">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Eric&#39;s Blog">
<meta name="twitter:description" content="Nothing much yet">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":true,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Eric's Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-101950574-1', 'auto');
  ga('send', 'pageview');
</script>











</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Eric's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">place to write</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/25/RecSys/Oryx 推荐系统初体验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/25/RecSys/Oryx 推荐系统初体验/" itemprop="url">Oryx 推荐系统初体验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-25T00:00:00+08:00">
                2014-08-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/25/RecSys/Oryx 推荐系统初体验/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/25/RecSys/Oryx 推荐系统初体验/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Oryx 推荐系统初体验</h1>
<h2>Summary</h2>
<p>Oryx 的前身叫 Myrrix，后来被 Cloudera 收购改了这个名字。值得一提的是 Oryx 的维护者就是 Mahout 的主要贡献者——<a href="https://github.com/srowen" target="_blank" rel="external">Sean Owen</a>
Oryx开源项目旨在提供实时的大规模机器学习/预测分析基础框架目前它实现了一列工程应用常用到的机器学习算法：协同过滤，分类/回归以及聚类。Oryx 通过Apache hadoop来实现对大规模的数据流进行建模。同时可以通过实时的REST API来对建好的模型进行查询，并且有也可以通过API将新数据输入到模型中进行训练。
<img src="https://camo.githubusercontent.com/6f77df14aea479fb653ced96298d0d59bd8a6d3f/68747470733a2f2f7261772e6769746875622e636f6d2f77696b692f636c6f75646572612f6f7279782f4f7279784c6f676f536d616c6c2e706e67" alt="oryx_logo">
Oryx 具有以下特点：</p>
<ul>
<li>Hadoop 版本跟着 CDH 升级</li>
<li>将推荐引擎分为 Serving Layer 和 Computing Layer，隔离出 Serving Layer 让扩展变得很容易</li>
<li>同时支持推荐、聚类、分类的机器学习</li>
<li>数据引入了 Generation 的概念，提供了很好的增量补充数据的支持</li>
</ul>
<p>目前Oryx release的版本是Oryx1.0，而<a href="https://github.com/OryxProject/oryx" target="_blank" rel="external">Oryx2.0</a>也正在孵化当中。相较于1.0版本，Oryx2.0更好的实现了<a href="http://lambda-architecture.net/" target="_blank" rel="external">lambda架构</a>，使得各个层之间可复用性更强。实现了比1更多的机器学习算法（1.0只实现了，ALS协同过滤，随机森林，以及K-means++算法）同时2.0版本还引入更新的Spark和Streaming技术。</p>
<h2>安装Oryx</h2>
<p>Oryx 的安装需要运行环境，以及Hadoop2.3或以后的运行环境，这里我们悬着Cloudera公司的CDH5发行的hadoop版本，也是官方推荐的版本。CDH5的安装，请参见<a href="http://youngfor.me/post/recsys/an-zhuang-cdh5-step-by-step" target="_blank" rel="external">上一篇文章</a>。
Oryx的Server层和Computation层都是独立的Jar包<code>oryx-serving-x.y.z.jar</code>和<code>oryx-computation-x.y.z.jar</code>，只需要用<code>java</code>命令单独的运行这两个Jar包即可。需要注意的是这里的两个jar包不是在<code>hadoop jar</code>命令中运行，只是在长期跑的服务器程序。</p>
<h2>跑Oryx例子stepBystep</h2>
<p><a href="https://github.com/cloudera/oryx#examples" target="_blank" rel="external">Orxy官方的项目</a>提供了3个机器学习的例子，分别是用协同过滤做推荐，用随机森林做分类，用K-means++做聚类。在运行这些例子之前我们先要做一下准备工作。</p>
<ol>
<li>已经建立了CDH5 或者Hadoop2.0+的环境，如果没有请参考<a href="">这里</a></li>
<li>运行<code>git -clone https://github.com/cloudera/oryx.git</code>，将项目下载到本地的机子上并用<code>unzip</code>命令解压，并cd到该目录下。
这样我们就准备好了，开始跑第一个例子吧。</li>
</ol>
<h3>例1.建立一个简单的推荐系统</h3>
<p>第一个例子采用了交替最小二乘的算法ALS (alternating least squares)是对<code>audioscrobbler</code>数据库（last.fm的音乐数据）的一些样本建立推荐系统。为了建立这个系统，ALS-Modle要求的输入的原始数据格式必须是<code>user</code>,<code>item</code>或者是<code>user</code>,<code>item</code>,<code>strength</code>。每列的数据必须用<code>,</code>隔开，前两列可以是任何数据类型（数字和非数字都可以），最后一列是可选的，但必须是数字类型。
我们看一眼<a href="http://raw.github.com/wiki/cloudera/oryx/datasets/audioscrobbler-sample.csv.gz" target="_blank" rel="external">audioscrobbler</a>数据库的数据。</p>
<pre><code>1000002,&quot;A Perfect Circle&quot;,144
1000002,&quot;Aerosmith&quot;,314
1000002,&quot;Metallica&quot;,329
1000002,&quot;Counting Crows&quot;,157
1000002,&quot;Dire Straits&quot;,125
1000002,&quot;Free&quot;,155
1000002,&quot;Guns N' Roses&quot;,236
1000002,&quot;Goo Goo Dolls&quot;,119
1000002,&quot;Michael Jackson&quot;,104
1000002,&quot;Barenaked Ladies&quot;,115
</code></pre>
<p>第一列为用户ID，第二列为歌手的名字，第三列为喜爱度。
正常情况下会把数据放在hadoop下跑，我们可以通过下面的指令把下载下来的数据库存放到hdfs上：</p>
<pre><code>hadoop fs -mkdir -p /user/oryx/example/00000/inbound
hadoop fs -copyFromLocal [data file] /user/oryx/example/00000/inbound/
</code></pre>
<p>这里我们只在本地做一下实验，将数据拷贝到<code>/tmp/oryx/example</code>:</p>
<pre><code>mkdir -p /tmp/oryx/example1/00000/inbound
cp audioscrobbler-sample.csv.gz /tmp/oryx/example/00000/inbound/	
</code></pre>
<p>为了运行Serving层和computation层，我们必须定义一个配置文件，来告诉程序如何运行。配置文件详细的说明可以在<code>common/src/main/resources/reference.conf</code>下查看。我们这的配置例子如下：</p>
<pre><code>model=${als-model}
model.instance-dir=/tmp/oryx/example1
model.local-computation=true
model.local-data=true
model.features=25
model.lambda=0.065	
</code></pre>
<p>我们可以用<code>vim oryx-example1.conf</code>新建一个配置文件将内容填入。
接着我们便可以运行计算层和服务层了。可以看到model类型为ALS-model，instance-dir，设定了存放数据的地址。</p>
<pre><code>java -Dconfig.file=oryx-example1.conf -jar computation/target/oryx-computation-1.0.1-SNAPSHOT.jar
</code></pre>
<p>我们可以看到程序的运行日志，看到从读取数据到不停跌代进行矩阵分解的整个过程
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/2a.png" alt="log">
接着我们运行serving层：</p>
<pre><code>sudo java -Dconfig.file=oryx-example1.conf -jar serving/target/oryx-serving-1.0.1-SNAPSHOT.jar
</code></pre>
<p>serving 层开启了Tomcat网络服务，并且加载了模型中的元素。日志如下：
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/3a.png" alt="log">
我们还可以在浏览器中查看运行的结果，在浏览器上输入<code>http:\\localhost</code>，我们便可以显示的看到所有oryx提供的API。
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/4a.png" alt="servinglayer">
包括对某一用户做推荐，物品间的相似度，用户对某个item的偏好，最受欢迎Item等等，甚至可以在原来数据的基础上添加数据再对这些数据进行推荐，非常方便。
在浏览器中输入<code>http:\\localhost:8080</code>可以查看计算时候的资源消耗等等一系列属性，由于我们是在本地跑，所以上面没有数据显示。
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/5a.png" alt="computinglayer"></p>
<p>至此我们的第一个实验就做完了。</p>
<h3>例2.利用随机森林算法做分类</h3>
<p>这里随机森林算法是机器学习中常用的算法，有关它的介绍可以看<a href="http://www.zilhua.com/629.html" target="_blank" rel="external">这里</a>。例子二对某一地区的森林覆盖类型做分类的例子。数据集采用了<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/covtype/" target="_blank" rel="external">UCL repository</a>。该数据集记录了581012个样本地区的54个特征，包括海拔，坡度，到最近水域的垂直距离和水平距离，土壤类型等等。更详细的描述可以参见<code>covtype.info</code>文件。
它的一条样本是这个样子的：
	2596,51,3,258,0,510,221,232,148,6279,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,5
跟例子1类似，我们同意需要配置文件<code>orxy-example2.conf</code>，在里面输入：</p>
<pre><code>model=${rdf-model}
model.instance-dir=/tmp/oryx/example2
model.local-computation=true
model.local-data=true
inbound.numeric-columns=[0,1,2,3,4,5,6,7,8,9]
inbound.target-column=54
inbound.column-names=[&quot;Elevation&quot;, &quot;Aspect&quot;, &quot;Slope&quot;, &quot;Horizontal_Distance_To_Hydrology&quot;,
  &quot;Vertical_Distance_To_Hydrology&quot;, &quot;Horizontal_Distance_To_Roadways&quot;, &quot;Hillshade_9am&quot;, &quot;Hillshade_Noon&quot;,
  &quot;Hillshade_3pm&quot;, &quot;Horizontal_Distance_To_Fire_Points&quot;, &quot;Wilderness_Area1&quot;, &quot;Wilderness_Area2&quot;,
  &quot;Wilderness_Area3&quot;, &quot;Wilderness_Area4&quot;, &quot;Soil_Type1&quot;, &quot;Soil_Type2&quot;, &quot;Soil_Type3&quot;, &quot;Soil_Type4&quot;,
  &quot;Soil_Type5&quot;, &quot;Soil_Type6&quot;, &quot;Soil_Type7&quot;, &quot;Soil_Type8&quot;, &quot;Soil_Type9&quot;, &quot;Soil_Type10&quot;, &quot;Soil_Type11&quot;,
  &quot;Soil_Type12&quot;, &quot;Soil_Type13&quot;, &quot;Soil_Type14&quot;, &quot;Soil_Type15&quot;, &quot;Soil_Type16&quot;, &quot;Soil_Type17&quot;, &quot;Soil_Type18&quot;,
  &quot;Soil_Type19&quot;, &quot;Soil_Type20&quot;, &quot;Soil_Type21&quot;, &quot;Soil_Type22&quot;, &quot;Soil_Type23&quot;, &quot;Soil_Type24&quot;, &quot;Soil_Type25&quot;,
  &quot;Soil_Type26&quot;, &quot;Soil_Type27&quot;, &quot;Soil_Type28&quot;, &quot;Soil_Type29&quot;, &quot;Soil_Type30&quot;, &quot;Soil_Type31&quot;, &quot;Soil_Type32&quot;,
  &quot;Soil_Type33&quot;, &quot;Soil_Type34&quot;, &quot;Soil_Type35&quot;, &quot;Soil_Type36&quot;, &quot;Soil_Type37&quot;, &quot;Soil_Type38&quot;, &quot;Soil_Type39&quot;,
  &quot;Soil_Type40&quot;, &quot;Cover_Type&quot;]
</code></pre>
<p>这里模型选择是rdf-model，同意定义了数据的一些格式0~9为数字，label列是滴54列，以及各个列的名名称。
然后我们把下载到的文件拷贝的<code>/tmp/oryx/example2/00000/inbound</code>下，按上例的方法运行serving层和computation层。只是配置文件做改变。</p>
<pre><code>java -Dconfig.file=oryx-example2.conf -jar 
computation/target/oryx-computation-1.0.1-SNAPSHOT.jar

sudo java -Dconfig.file=oryx-example2.conf -jar serving/target/oryx-serving-1.0.1-SNAPSHOT.jar
</code></pre>
<p>计算层的时间会比较长，需要较长时间等待。相信在集群上跑回好很多。
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/6a.png" alt="servingLayer">
我们可以在<code>/classify</code>栏里手动的输入一个样本：</p>
<pre><code>2500,51,3,258,0,510,221,232,148,6279,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,
</code></pre>
<p>进行判别，得到分类结果。</p>
<h3>例3.使用K-means++算法聚类</h3>
<p>oryx的聚类算法采用了<a href="http://arxiv.org/abs/1203.6402" target="_blank" rel="external">Scalable K-Means++算法</a>。数据集使用<a href="http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html" target="_blank" rel="external">KDD Cup 1999的数据</a>，kddcup.data_10_percent.gz A 10% subset. (2.1M; 75M Uncompressed)。
由于内存较小，在用-Xmx 1024m分配了1G内存后，运行过程还是出现了OutofMemoryError。所以在本地单机没法进行，serve层开放的API如下：
<img src="/2014/08/25/RecSys/Oryx 推荐系统初体验/7a.png" alt="servingLayer">
可以使用<code>/assign</code>对新样本进行聚类。</p>
<pre><code>0,tcp,http,SF,259,14420,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0.00,0.00,0.00,0.00,1.00,0.00,0.00,11,97,1.00,0.00,0.09,0.08,0.00,0.00,0.00,0.00
</code></pre>
<h2>总结</h2>
<p>至此我们就初步体验了oryx这个开源的大规模机器学习框架，虽然目前oryx实现的算法比较少，但是可以看到他的lamda架构，提供Rest API，generation概念，以及对Hadoop乃至Spark的适配，必将使得它在未来推荐系统领域占领一席之地。</p>
<h2>参考</h2>
<p><a href="https://github.com/cloudera/oryx" target="_blank" rel="external">oryx官方github</a>
<a href="http://liangshan.me/blog/2014/06/08/build-a-scalable-recommendation-system/" target="_blank" rel="external">build-a-scalable-recommendation-system</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/14/RecSys/安装CDH5 step by step/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/14/RecSys/安装CDH5 step by step/" itemprop="url">安装CDH5 step by step</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-14T00:00:00+08:00">
                2014-08-14
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/14/RecSys/安装CDH5 step by step/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/14/RecSys/安装CDH5 step by step/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>安装CDH5 step by step</h2>
<p><img src="http://www.wacpp.com/attachments/2011/07/1_201107040654254hhuy.jpg" alt="ClouderaLogo">
Cdh5安装基本上按照官网的<a href="http://www.cloudera.com/content/cloudera-content/cloudera-docs/CDH5/latest/CDH5-Quick-Start/cdh5qs_prereq.html" target="_blank" rel="external">手册</a>进行安装。我们所用的系统环境是<code>win7+VirtualBox-4.3.12+Centos6.5</code>,下面让我们开始吧：</p>
<h3>首先我们如果你装了老版本的Hadoop我们先把他移除，没装就可以无视：</h3>
<p>1.暂停hadoop服务：</p>
<pre><code>	$ for x in `cd /etc/init.d ; ls hadoop-hdfs-*` ; do sudo service $x stop ; done 
	$ for x in 'cd /etc/init.d ; ls hadoop-0.20-mapreduce-*' ; do sudo service $x stop ; done
</code></pre>
<p>2.移除hadoop-0.20-conf-pseudo:</p>
<pre><code>	$ sudo yum remove hadoop-0.20-conf-pseudo hadoop-0.20-mapreduce-*
</code></pre>
<h3>安装Java：</h3>
<ol>
<li>从<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html" target="_blank" rel="external">oracle</a>上现在下载适合CHD5'.tar.gz'的JDK文件，目前支持的版本是java1.7.0_55.</li>
<li>Extract the JDK to <code>/usr/java/jdk-version</code>; for example <code>/usr/java/jdk.1.7.0_nn</code>, where is a nn is a supported version.
3.In <code>/etc/default/bigtop-utils</code>, set JAVA_HOME to the directory where the JDK is installed; for example:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=/usr/java/default</div></pre></td></tr></table></figure></li>
</ol>
<p>Symbolically link the directory where the JDK is installed to /usr/java/default; for example:</p>
<pre><code>ln -s /usr/java/jdk.1.7.0_nn /usr/java/default
</code></pre>
<h3>下载CDH5包文件</h3>
<p>下载支持CentOS的<a href="http://archive.cloudera.com/cdh5/one-click-install/redhat/5/x86_64/cloudera-cdh-5-0.x86_64.rpm" target="_blank" rel="external">CDH5版本</a>，然后使用yum命令在本地安装：</p>
<pre><code>$ sudo yum --nogpgcheck localinstall cloudera-cdh-5-0.x86_64.rpm 
</code></pre>
<h3>开始安装</h3>
<ol>
<li>(Optionally) add a repository key:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo rpm --import http://archive.cloudera.com/cdh5/redhat/5/x86_64/cdh/RPM-GPG-KEY-cloudera</div></pre></td></tr></table></figure></li>
</ol>
<p>2.安装Hadoop伪节点模式</p>
<pre><code>$ sudo yum install hadoop-conf-pseudo
</code></pre>
<h3>启动Hadoop并验证环境</h3>
<p>至此，Hadoop的伪节点安装已经完毕，下面我们就开始做一些配置，并启动Hadoop。</p>
<ol>
<li>
<p>格式化NameNode
首先切换输入<code>su</code>切换到root用户，接着输入命令:</p>
<p>$ sudo -u hdfs hdfs namenode -format</p>
</li>
</ol>
<p>第一次使用必须格式化NameNode</p>
<ol start="2">
<li>
<p>启动HDFS</p>
<p>for x in <code>cd /etc/init.d ; ls hadoop-hdfs-*</code> ; do sudo service $x start ; done</p>
</li>
</ol>
<p>为了验证是否启动成功，可以在浏览器里输入地址：<code>http:\\localhost:50070</code> 进行查看,可以看到分布式文件系统的熔炼，数据节点个数，以及日志，在伪分布节点配置下，你只能够看到一个活动的节点<code>localhost</code>。
3.创建<code>/tmp</code>，Staging 以及Log的目录：</p>
<pre><code>$ sudo -u hdfs hadoop fs -mkdir -p /tmp/hadoop-yarn/staging/history/done_intermediate
$ sudo -u hdfs hadoop fs -chown -R mapred:mapred /tmp/hadoop-yarn/staging 
$ sudo -u hdfs hadoop fs -chmod -R 1777 /tmp 
$ sudo -u hdfs hadoop fs -mkdir -p /var/log/hadoop-yarn
$ sudo -u hdfs hadoop fs -chown yarn:mapred /var/log/hadoop-yarn
</code></pre>
<ol start="4">
<li>
<p>运行下面的指令，来查看文件是否建立:</p>
<p>$ sudo -u hdfs hadoop fs -ls -R /</p>
</li>
</ol>
<p>我们可以看到刚刚在HDFS上建立的目录结构：</p>
<pre><code>drwxrwxrwt - hdfs supergroup 0 2012-05-31 15:31 /tmp
drwxr-xr-x - hdfs supergroup 0 2012-05-31 15:31 /tmp/hadoop-yarn
drwxrwxrwt - mapred mapred 0 2012-05-31 15:31 /tmp/hadoop-yarn/staging
drwxr-xr-x - mapred mapred 0 2012-05-31 15:31 /tmp/hadoop-yarn/staging/history
drwxrwxrwt - mapred mapred 0 2012-05-31 15:31 /tmp/hadoop-yarn/staging/history/done_intermediate
drwxr-xr-x - hdfs supergroup 0 2012-05-31 15:31 /var
drwxr-xr-x - hdfs supergroup 0 2012-05-31 15:31 /var/log
drwxr-xr-x - yarn mapred 0 2012-05-31 15:31 /var/log/hadoop-yarn
</code></pre>
<ol start="5">
<li>
<p>启动<a href="http://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html" target="_blank" rel="external">YARN</a>(YARN是MapReduce的升级版)</p>
<pre><code>$ sudo service hadoop-yarn-resourcemanager start 
$ sudo service hadoop-yarn-nodemanager start 
$ sudo service hadoop-mapreduce-historyserver start
</code></pre>
</li>
<li>
<p>创建用户目录
为每个MapReduce 用户创建home目录，例如：</p>
<pre><code>$ sudo -u hdfs hadoop fs -mkdir -p /user/&lt;user&gt; 
$ sudo -u hdfs hadoop fs -chown &lt;user&gt; /user/&lt;user&gt;
</code></pre>
</li>
</ol>
<p>这里我们的用户名是Cdh5，拿他可以替换掉&lt;User&gt;便可以。
至此，我们的环境配置便已经完成，下面我们跑个例子来检验一下。</p>
<h3>跑一个YARN的例子</h3>
<ol>
<li>
<p>首先我们根据上面的例子创建一个Hadoop用户：</p>
<pre><code>$ sudo -u hdfs hadoop fs -mkdir -p /user/joe 
$ sudo -u hdfs hadoop fs -chown joe /user/joe
</code></pre>
</li>
</ol>
<p>2.然后我们通过<code>su joe</code>切换到用户joe,创建<code>input</code>目录，并且将几个xml文件复制到该目录下：</p>
<pre><code>	$ hadoop fs -mkdir input
	$ hadoop fs -put /etc/hadoop/conf/*.xml input
	$ hadoop fs -ls input
	Found 3 items:
	-rw-r--r-- 1 joe supergroup 1348 2012-02-13 12:21 input/core-site.xml
	-rw-r--r-- 1 joe supergroup 1913 2012-02-13 12:21 input/hdfs-site.xml
	-rw-r--r-- 1 joe supergroup 1001 2012-02-13 12:21 input/mapred-site.xml
</code></pre>
<ol start="3">
<li>
<p>设置用户joe的环境变量：</p>
<pre><code>$ export HADOOP_MAPRED_HOME=/usr/lib/hadoop-mapreduce
</code></pre>
</li>
<li>
<p>运行mapred的例子。这个例子是从input目录中查找<code>dfs[a-z.]+</code>这一正则表达式的匹配字段，命令如下：</p>
<pre><code>$ hadoop jar /usr/lib/hadoop-mapreduce/hadoop-mapreduce-examples.jar grep input output23 'dfs[a-z.]+'
</code></pre>
</li>
<li>
<p>这之后便可以查看output23目录，</p>
</li>
</ol>
<pre><code>	$ hadoop fs -ls output23 
	Found 2 items
	drwxr-xr-x - joe supergroup 0 2009-02-25 10:33 /user/joe/output23/_SUCCESS
	-rw-r--r-- 1 joe supergroup 1068 2009-02-25 10:33 /user/joe/output23/part-r-00000
</code></pre>
<ol start="6">
<li>
<p>我们的运行结果就在<code>part-r-00000</code>文件里，我们可以查看：</p>
<pre><code>$ hadoop fs -cat output23/part-r-00000 | head

1 dfs.safemode.min.datanodes
1 dfs.safemode.extension
1 dfs.replication
1 dfs.permissions.enabled
1 dfs.namenode.name.dir
1 dfs.namenode.checkpoint.dir
1 dfs.datanode.data.dir
</code></pre>
</li>
</ol>
<p>至此，我们的CDH 5运行环境便搭配完毕，我们可以在该环境下跑hadoop程序了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/13/Spider/Spider/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/13/Spider/Spider/" itemprop="url">爬虫 工具——Scrapy 介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-13T13:58:42+08:00">
                2014-08-13
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/13/Spider/Spider/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/13/Spider/Spider/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>基于Python的crawler</h1>
<p>考虑到垂直爬虫及站内搜索的重要性，重新思考一下项目爬虫的技术架构及实现方案</p>
<h2>考察垂直爬虫的几个原则：</h2>
<blockquote>
<p>性能较高：较好支持多线程并发处理；支持异步、非阻塞socket；支持分布式爬取；爬取调度算法性能较高；内存使用效率较高，不要老是出现out of memory问题；
架构优美：组件式设计式架构，扩展方便；架构设计精巧。至少值得花时间去学习架构设计思想。
扩展方便：能够与现有框架较好集成；由于是垂直爬虫，需要针对不同的网页定制爬取规则集逻辑，需要能够方便测试，不要老是重新编译，因此最好支持python等脚本语言
功能全面：内置支持ajax/javascript爬取、登录认证、深度爬取设置、类似heritrix的爬取过滤器（filter）、页面压缩处理等
管理功能：提供爬虫管理接口，能够实时监控和管理爬取</p>
</blockquote>
<p>厌烦了基于java的爬虫方案，尤其是考虑到python在网络编程上的易用性，因此打算考察基于python做新版本爬虫的可行性，刚好把久不使用的python捡起来。</p>
<p>整理了一下目前基于python的crawler，大致有如下一些现成的项目方案可供参考：</p>
<ul>
<li>
<p>Mechanize：http://wwwsearch.sourceforge.net/mechanize/</p>
</li>
<li>
<p>Twill：http://twill.idyll.org/</p>
</li>
<li>
<p>Scrapy：http://scrapy.org</p>
</li>
<li>
<p>HarvestMan：http://www.harvestmanontheweb.com/</p>
</li>
<li>
<p>Ruya：http://ruya.sourceforge.net/</p>
</li>
<li>
<p>psilib：http://pypi.python.org/pypi/spider.py/0.5</p>
</li>
<li>
<p>BeautifulSoup + urllib2：http://www.crummy.com/software/BeautifulSoup/</p>
</li>
</ul>
<p>比较之后，选择Scrapy作为重点考察学习对象，尽管没有Mechanize及Harvestman成熟，但从其架构来看，还是很有前途的，尤其是基于twisted高性能框架的架构，很有吸引力。</p>
<h2>scrapy的架构图：</h2>
<p><img src="http://blog.pluskid.org/wp-content/uploads/2009/08/scrapy_architecture.png" alt="scrapy架构"></p>
<h2>scrapy 包含的component如下：</h2>
<p>Components</p>
<ul>
<li>
<p>Scrapy Engine
The engine is responsible for controlling the data flow between all components of the system, and triggering events when certain actions occur. See the Data Flow section below for more details.</p>
</li>
<li>
<p>Scheduler
The Scheduler receives requests from the engine and enqueues them for feeding them later (also to the engine) when the engine requests them.</p>
</li>
<li>
<p>Downloader
The Downloader is responsible for fetching web pages and feeding them to the engine which, in turns, feeds them to the spiders.</p>
</li>
<li>
<p>Spiders
Spiders are custom classes written by Scrapy users to parse response and extract items (aka scraped items) from them or additional URLs (requests) to follow. Each spider is able to handle a specific domain (or group of domains). For more information see Spiders.</p>
</li>
<li>
<p>Item Pipeline
The Item Pipeline is responsible for processing the items once they have been extracted (or scraped) by the spiders. Typical tasks include cleansing, validation and persistence (like storing the item in a database). For more information see Item Pipeline.</p>
</li>
<li>
<p>Downloader middlewares
Downloader middlewares are specific hooks that sit between the Engine and the Downloader and process requests when they pass from the Engine to the downloader, and responses that pass from Downloader to the Engine. They provide a convenient mechanism for extending Scrapy functionality by plugging custom code. For more information see Downloader Middleware.</p>
</li>
<li>
<p>Spider middlewares
Spider middlewares are specific hooks that sit between the Engine and the Spiders and are able to process spider input (responses) and output (items and requests). They provide a convenient mechanism for extending Scrapy functionality by plugging custom code. For more information see Spider Middleware.</p>
</li>
<li>
<p>Scheduler middlewares
Spider middlewares are specific hooks that sit between the Engine and the Scheduler and process requests when they pass from the Engine to the Scheduler and vice-versa. They provide a convenient mechanism for extending Scrapy functionality by plugging custom code.</p>
</li>
</ul>
<h2>Frequently Asked Questions</h2>
<p>How does Scrapy compare to BeautifulSoup or lxml?</p>
<blockquote>
<p>BeautifulSoup and lxml are libraries for parsing HTML and XML. Scrapy is an application framework for writing web spiders that crawl web sites and extract data from them.</p>
</blockquote>
<blockquote>
<p>Scrapy provides a built-in mechanism for extracting data (called selectors) but you can easily use BeautifulSoup (or lxml) instead, if you feel more comfortable working with them. After all, they’re just parsing libraries which can be imported and used from any Python code.</p>
</blockquote>
<blockquote>
<p>In other words, comparing BeautifulSoup (or lxml) to Scrapy is like comparing jinja2 to Django.</p>
</blockquote>
<p>How is BeautifulSoup different from Scrapy?[3]</p>
<blockquote>
<p>Scrapy is a Web-spider or web scraper framework, You give Scrapy a root URL to start crawling, then you can specify constraints on how many number of Urls you want to crawl and fetch,etc., It is a complete framework for Web-scrapping or crawling.</p>
</blockquote>
<blockquote>
<p>While</p>
</blockquote>
<blockquote>
<p>Beautiful Soup is a parsing library which also does pretty job of fetching contents from Url and allows you to parse certain parts of them without any hassle. It only fetches the contents of the URL that you give and stops. It does not crawl unless you manually put it inside a infinite loop with certain criteria.</p>
</blockquote>
<blockquote>
<p>In simple words, with Beautiful Soup you can build something similar to Scrapy.
Beautiful Soup is a library while Scrapy is a complete framework.</p>
</blockquote>
<h2>References</h2>
<p>[1]<a href="http://www.yeeach.com/post/491" target="_blank" rel="external">基于python的crwaler</a>
[2]<a href="http://doc.scrapy.org" target="_blank" rel="external">doc.scarpy.org</a>
[3]<a href="http://www.quora.com/Python-programming-language-1/How-is-BeautifulSoup-different-from-Scrapy" target="_blank" rel="external">How-is-BeautifulSoup-different-from-Scrapy</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/12/Data structure and Algorithms/Data Structure--Binary search trees/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/12/Data structure and Algorithms/Data Structure--Binary search trees/" itemprop="url">Data Structure--Binary search trees</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-12T00:00:00+08:00">
                2014-08-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/12/Data structure and Algorithms/Data Structure--Binary search trees/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/12/Data structure and Algorithms/Data Structure--Binary search trees/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Data Structure--Binary search trees</h1>
<h2>Definition.  A BST is a binary tree in  symmetric order</h2>
<p>A binary tree is either:
・Empty.
・Two disjoint binary trees (left and right).</p>
<h2>Symmetric order.   Each node has a key,</h2>
<p>and every node’s key is:
・Larger than all keys in its left subtree.
・Smaller than all keys in its right subtree.</p>
<p>Java definition A BST is a reference to a root Node.</p>
<p>A Node is comprised of four fields:</p>
<ul>
<li>A key and A vaule.</li>
<li>A reference to the left and right subtrees
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">	<span class="keyword">private</span> Key key;</div><div class="line">	<span class="keyword">private</span> Vaule val；</div><div class="line">	<span class="keyword">private</span> Node left,right;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> count;<span class="comment">//for size()</span></div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Node</span><span class="params">(Key key,Vaule val)</span></span>&#123;</div><div class="line">		<span class="keyword">this</span>.key=key;</div><div class="line">		<span class="keyword">this</span>.vaule=val;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ul>
<p>BST implementation(Skeleton)	
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BST</span>&lt;<span class="title">Key</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">Key</span>&gt;,<span class="title">Vaule</span>&gt;</span>&#123;</div><div class="line">	<span class="keyword">private</span> Node root;</div><div class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span></div><div class="line">	&#123;<span class="comment">/* see above*/</span>&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> Vaule <span class="title">get</span><span class="params">(Key,key)</span></span></div><div class="line">	&#123;<span class="comment">/*see next*/</span>		&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key,Vaule val)</span></span></div><div class="line">	&#123;<span class="comment">/*see next*/</span>		&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Key key)</span></span>&#123;&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> Iterable&lt;Key&gt; <span class="title">iterator</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Get. Return Vaule corresponding to given key, or null if no such key.
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Vaule <span class="title">get</span><span class="params">(Key key)</span></span>&#123;</div><div class="line">	Node cur=root;</div><div class="line">	<span class="keyword">int</span> cmp;</div><div class="line">	<span class="keyword">while</span>(cur!=<span class="keyword">null</span>)&#123;</div><div class="line">		cmp=cur.key.CompareTo(Key));</div><div class="line">		<span class="keyword">if</span>(cmp&gt;<span class="number">0</span>) </div><div class="line">			cur=cur.left;</div><div class="line">		<span class="keyword">if</span> (cmp&lt;<span class="number">0</span>) &#123;</div><div class="line">			cur=cur.right;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> </div><div class="line">			<span class="keyword">return</span> cur.Vaule;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Put	.Associate value with key.(Tricky and recursive)</p>
<p>Search for key, then two cases:
・Key in tree   ⇒  reset value.
・Key not in tree ⇒  add new node
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key,Vaule val)</span></span>&#123;</div><div class="line">	root=put(root,key,val);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">put</span><span class="params">(Node node,Key key,Vaule val)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> (node==<span class="keyword">null</span>) &#123; <span class="comment">//如果没有节点，则新建节点，如果原来不含该节点，最终都到这步</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Node(key,val);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		cmp=key.CompareTo(node.key);</div><div class="line">		<span class="keyword">if</span> (cmp&gt;<span class="number">0</span>) </div><div class="line">			node.right=put(node.right,key,val);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>) </div><div class="line">			node.left=put(node.left,key,value);</div><div class="line">		<span class="keyword">else</span> </div><div class="line">			node.value=val;	</div><div class="line">							</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">return</span> node;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2>Ordered Operations</h2>
<ol>
<li>
<p>如何求最大/最小值 ？
很简单，我们可以根据二叉查找树的定义，判定最左的子节点即为最小值，最右的为最大值。</p>
</li>
<li>
<p>如何写Floor和Ceiling 函数？(Floor.  Largest key  ≤ a given key.Ceiling.  Smallest key ≥ a given key.)
Q.  How to find the floor / ceiling?
<strong>Case 1</strong>.  [k equals the key at root]
The floor of k is  k.
<strong>Case 2</strong>.  [k is less than the key at root]
The floor of k is in the left subtree.
<strong>Case 3</strong>.  [k is greater than the key at root]
The floor of k is in the right subtree
(if there is any key ≤ k in right subtree);
otherwise it is the key in the root.
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Key <span class="title">floor</span><span class="params">(Key k)</span></span>&#123;</div><div class="line">    </div><div class="line">    Node X=floor(root,k);</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">return</span> X.Key;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">floor</span><span class="params">(Node X,Key k)</span></span>&#123;</div><div class="line">    Node Y;</div><div class="line">    <span class="keyword">if</span>(X=<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">int</span> cmp=k.compareTo(X.key);</div><div class="line">    <span class="keyword">if</span>(cmp&lt;<span class="number">0</span>)</div><div class="line">        retrun Y=floor(X.left,k);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cmp==<span class="number">0</span>)    <span class="keyword">return</span> X;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (floor(X.right,k)!=<span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> floor(X.right,k);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> X;  </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</li>
<li>
<p>求数的大小：
方法：在每个节点存储字数节点个数的值，使用size函数，使得它返回该节点的count值，这样的话，节点必须新加一个变量count，size函数这么写：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> Key key;</div><div class="line">    <span class="keyword">private</span> Value val;</div><div class="line">    <span class="keyword">private</span> Node left;</div><div class="line">    <span class="keyword">private</span> Node right;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</li>
</ol>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> size(root);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">(Node X)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(X==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">return</span> X.count;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这样put函数里应该多加这么一句：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Key key,Vaule val)</span></span>&#123;</div><div class="line">        root=put(root,key,val);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> Node <span class="title">put</span><span class="params">(Node node,Key key,Vaule val)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (node==<span class="keyword">null</span>) &#123; <span class="comment">//如果没有节点，则新建节点，如果原来不含该节点，最终都到这步</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Node(key,val);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            cmp=key.CompareTo(node.key);</div><div class="line">            <span class="keyword">if</span> (cmp&gt;<span class="number">0</span>) </div><div class="line">                node.right=put(node.right,key,val);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>) </div><div class="line">                node.left=put(node.left,key,value);</div><div class="line">            <span class="keyword">else</span> </div><div class="line">                node.value=val;                               </div><div class="line">            &#125;</div><div class="line">            <span class="comment">//return 前添加一句count值</span></div><div class="line">            node.count=<span class="number">1</span>+size(node.left)+size(node.right);</div><div class="line">            <span class="keyword">return</span> node;</div><div class="line">    &#125;</div><div class="line">java    </div><div class="line"><span class="number">4</span>. 排序统计问题（Rank）</div><div class="line">   Q. How many keys &lt; k  ?</div><div class="line"></div><div class="line">    ```<span class="function">java</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(Key k)</span>&#123;</div><div class="line">         <span class="keyword">int</span> num=rank(root,k);</div><div class="line">         <span class="keyword">return</span> num;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(Node X,Key k)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (X==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> cmp =k.compareTo(X.key);</div><div class="line">        <span class="keyword">if</span> (cmp==<span class="number">0</span>) <span class="keyword">return</span> size(X.left)<span class="comment">//注意，size函数包括自己</span></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (cmp&lt;<span class="number">0</span>) <span class="keyword">return</span> rank(X.left,k);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>+rank(X.left,k)+rank(X.right,k);</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<ol start="5">
<li>迭代写法</li>
</ol>
<p>方法，用队列实现，先存左边的node，再存root及节点，再存右边的节点。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> Iterable&lt;Key&gt;Keys()&#123;</div><div class="line">    Queue&lt;Key&gt; q = <span class="keyword">new</span> Queue&lt;Key&gt;();</div><div class="line">    inorder(root,q);</div><div class="line">    <span class="keyword">return</span> q;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">inorder</span><span class="params">(Node X,Queue&lt;Key&gt;,q)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(X==<span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">    inorder(X.left,q);</div><div class="line">    enquue(X.Key);</div><div class="line">    inorder(X.right,q);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol start="6">
<li>算法比较</li>
</ol>
<p><img src="/2014/08/12/Data structure and Algorithms/Data Structure--Binary search trees/6.png" alt="pic">
可见二叉查找树和二分查找的比较，二叉查找树算法复杂度与树的高度成正比，而二叉查找树树的高度又和二叉查找树的动态存储的数据结构，在插入方面更有优势（红线划到insert处）。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/05/RecSys/Mahout source code modification and re-compile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/05/RecSys/Mahout source code modification and re-compile/" itemprop="url">Mahout source code modification and re-compile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-05T21:47:35+08:00">
                2014-08-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/05/RecSys/Mahout source code modification and re-compile/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/05/RecSys/Mahout source code modification and re-compile/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Mahout source code modification and re-compile</h1>
<blockquote>
<p>author: sheng junhui</p>
</blockquote>
<blockquote>
<p>weibo: @armysheng</p>
</blockquote>
<blockquote>
<p>blog: youngfor.me</p>
</blockquote>
<blockquote>
<p>email: armysheng@gmail.com</p>
</blockquote>
<p>1.unzip your downloaded mahout src file <code>mahout-distribution-0.9-src</code>, import this maven project to eclipse;</p>
<p>2.new a test class at project <code>mahout-core</code> with package name <code>org.apache.mahout.test</code>,name <code>modifytest.java</code>;</p>
<p>3.implement this <code>modifytest</code> class with code as follows:</p>
<pre><code>package org.apache.mahout.test;

public class modifytest {
	public static void hello(){
		System.out.println(&quot;modifytest success !&quot;);
	}
}
</code></pre>
<p>4.re-compile the project by right click the <code>pom.xml</code> of  <code>mahout-core</code> project, choose <code>Run as</code> + <code>Maven build</code> and fill the <code>goal</code> option with <code>-DskipTests clean install</code>, then the compile starts and it will take few minutes.</p>
<p>After successful compliation you should see:</p>
<pre><code>[INFO] Building jar: D:\workspace\Mahout\mahout-distribution-0.9\core\target\mahout-core-0.9-sources.jar
[INFO] 
[INFO] --- maven-install-plugin:2.5.1:install (default-install) @ mahout-core ---
[INFO] Installing D:\workspace\Mahout\mahout-distribution-0.9\core\target\mahout-core-0.9.jar to C:\Users\shengjh\.m2\repository\org\apache\mahout\mahout-core\0.9\mahout-core-0.9.jar
[INFO] Installing D:\workspace\Mahout\mahout-distribution-0.9\core\pom.xml to C:\Users\shengjh\.m2\repository\org\apache\mahout\mahout-core\0.9\mahout-core-0.9.pom
[INFO] Installing D:\workspace\Mahout\mahout-distribution-0.9\core\target\mahout-core-0.9-tests.jar to C:\Users\shengjh\.m2\repository\org\apache\mahout\mahout-core\0.9\mahout-core-0.9-tests.jar
[INFO] Installing D:\workspace\Mahout\mahout-distribution-0.9\core\target\mahout-core-0.9-job.jar to C:\Users\shengjh\.m2\repository\org\apache\mahout\mahout-core\0.9\mahout-core-0.9-job.jar
[INFO] Installing D:\workspace\Mahout\mahout-distribution-0.9\core\target\mahout-core-0.9-sources.jar to C:\Users\shengjh\.m2\repository\org\apache\mahout\mahout-core\0.9\mahout-core-0.9-sources.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 45.205 s
[INFO] Finished at: 2014-06-11T13:57:27+08:00
[INFO] Final Memory: 25M/124M
[INFO] ------------------------------------------------------------------------
</code></pre>
<p>After this step, we have added a new class in mahout source code at <code>mahout-core</code>. Now let's see if it works.</p>
<p>5.build a new simple maven project with eclipse named <code>modifytest</code> or others, add the mahout dependency into the <code>pom.xml</code> file.</p>
<pre><code>&lt;dependencies&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.mahout&lt;/groupId&gt;
    &lt;artifactId&gt;mahout-core&lt;/artifactId&gt;
    &lt;version&gt;0.9&lt;/version&gt;
&lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<p>add a new class named <code>test.java</code> to this project and implement with code:</p>
<pre><code>	package com.docomo.muc.mahoutlearning;

	import org.apache.mahout.test.modifytest;

	public class test {
		public static void main(String[] args){
			modifytest tt= new modifytest();
			tt.hello();
		}
	}
</code></pre>
<p>Hit <code>crtl</code>+<code>F11</code> to run this project, and we can see the print output:</p>
<pre><code>	modifytest success !</code></pre>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/01/Data structure and Algorithms/Little trick--Sort two ordered array/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/01/Data structure and Algorithms/Little trick--Sort two ordered array/" itemprop="url">Little trick--Sort two ordered array</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-01T15:29:00+08:00">
                2014-08-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/01/Data structure and Algorithms/Little trick--Sort two ordered array/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/01/Data structure and Algorithms/Little trick--Sort two ordered array/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2>Problem:</h2>
<blockquote>
<p>Given two sorted integer arrays A and B, merge B into A as one sorted array.</p>
</blockquote>
<h2>Note:</h2>
<blockquote>
<p>You may assume that A has enough space to hold additional elements from B. The number of elements initialized in A and B are m and n respectively.
对于两个排好序的数组，如何进行合并呢？
主要思想是定义两个指针，数组从尾到头比较，直到有一个数组到头，如果B到头，则返回，如果A到头，继续将B内的元素放到A的前面部分
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> m, <span class="keyword">int</span> B[], <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> i=m-<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> j=n-<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> newlen=m+n-<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(i&gt;=<span class="number">0</span>&amp;&amp;j&gt;=<span class="number">0</span>)&#123;  <span class="comment">//loop until one array get to the head</span></div><div class="line">            <span class="keyword">if</span>(A[i]&lt;B[j])</div><div class="line">                A[newlen--]=B[j--];</div><div class="line">            <span class="keyword">else</span></div><div class="line">                A[newlen--]=A[i--];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span>(j&gt;=<span class="number">0</span>) <span class="comment">//if A reaches its head, copy the remained entrys of B to newA;</span></div><div class="line">            A[newlen--]=B[j--];</div><div class="line">        <span class="comment">//if B reaches its head, there' s no need to copy the remained entrys of A to newA;</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span>[] A =<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</div><div class="line">        A[<span class="number">0</span>]=<span class="number">7</span>;</div><div class="line">        A[<span class="number">1</span>]=<span class="number">9</span>;</div><div class="line">        A[<span class="number">2</span>]=<span class="number">10</span>;</div><div class="line">        <span class="keyword">int</span>[] B = &#123;<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</div><div class="line">        merge(A,<span class="number">3</span>,B,<span class="number">3</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> entry :A)</div><div class="line">            System.out.print(entry+<span class="string">" "</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/08/01/RecSys/Mahout 推荐系统源码分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/01/RecSys/Mahout 推荐系统源码分析/" itemprop="url">Mahout推荐系统源码分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-01T00:00:00+08:00">
                2014-08-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/08/01/RecSys/Mahout 推荐系统源码分析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/08/01/RecSys/Mahout 推荐系统源码分析/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Mahout推荐系统源码分析</h1>
<blockquote>
<p>author: sheng junhui</p>
</blockquote>
<blockquote>
<p>weibo: @armysheng</p>
</blockquote>
<blockquote>
<p>blog: youngfor.me</p>
</blockquote>
<blockquote>
<p>email: armysheng@gmail.com</p>
</blockquote>
<h2>Mahout下个性化推荐引擎Taste介绍</h2>
<blockquote>
<p>以下讨论基于Mahout 版本 version0.9</p>
</blockquote>
<p>本文关心的是如何利用Mahout在非分布式，非Hadoop based 情况下（即单机模式下）建立一个协同滤波的推荐系统。
Taste曾经是一个独立的项目，现在在Mahout和其他基于Hadoop的项目中发展。相对与目前的研究重点*--如何将推荐算法在Hadoop等分布式计算上实现--*Taste项目可以是一个更加独立，更加综合，更加稳定的项目。也被认为是学习和理解Mahout推荐引擎的基本入门点。
基于系协同滤波的Mahout推荐引擎可以通过用户对某些物品的喜好的计算，来得到用户对另一些物品的喜好。比如说一个卖书或者CD的网站，可以个根据用户以往的购买经历和喜好等数据，轻松的利用Mahout来得到用户对其他的那些书或者CD感兴趣。</p>
<p>Mahout提供了一组丰富的组件,您可以选择特定的算法构建一个定制的推荐系统。并且Mahout设计时考虑到了企业级的应用，高性能、可伸缩性和灵活性。</p>
<p>在构建推荐系统是，Mahout的顶层的packages中用到的接口有这些：</p>
<ul>
<li>DataModel</li>
<li>UserSimilarity</li>
<li>ItemSimilarity</li>
<li>UserNeighborhood</li>
<li>Recommender</li>
</ul>
<p>在<code>org.apache.mahout.cf.taste.impl</code>这个包中有对这些接口的实现。所有这些包就是你在搭建自己的推荐系统时需要用到的。</p>
<p>架构图：</p>
<p><img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/taste-architecture.png" alt="pic1">
改图显示了在一个Userbased 推荐器中，各个Mahout组件之间的关系。Item-base的推荐系统也与之类似，只是不包含Neighborhood算法。</p>
<h2>标准化的开发过程</h2>
<p>以UserCF的推荐算法为例，官方建议我们的开发过程：
<img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/mahout_recommendation-process.png" alt="pic2"></p>
<p>图片摘自Mahout in Action
从上图中我们可以看到，算法是被模块化的，通过1,2,3,4的过程进行方法调用。我们可以使用如下的简单代码来实现一个User-based CF算法。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleRecommender</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, Exception</span>&#123;</div><div class="line">            </div><div class="line">            <span class="comment">//读取数据，利用DataModel类建立数学模型</span></div><div class="line">            DataModel model = <span class="keyword">new</span> FileDataModel (<span class="keyword">new</span> File(<span class="string">"dataset.csv"</span>));</div><div class="line">            <span class="comment">//利用PearsonCorrelationSimilarity()函数建立用户的相似度</span></div><div class="line">            UserSimilarity similarity = <span class="keyword">new</span> PearsonCorrelationSimilarity(model);</div><div class="line">            <span class="comment">//利用ThresholdUserNeighborhood()函数得到和用户最相似的其他用户</span></div><div class="line">            UserNeighborhood neighborhood = <span class="keyword">new</span> ThresholdUserNeighborhood(<span class="number">0.1</span>, similarity, model);</div><div class="line">            <span class="comment">//利用GenericUserBasedRecommender()函数构造推荐器recommeder,至此推荐器构造完成</span></div><div class="line">            UserBasedRecommender recommender = <span class="keyword">new</span> GenericUserBasedRecommender(model, neighborhood, similarity);</div><div class="line">            </div><div class="line">            <span class="comment">//检验构造器与显示结果，222和5参数代表推荐给UID为222的用户前5个偏好度最大的商品</span></div><div class="line">            List&lt;RecommendedItem&gt;  recommendations =  recommender.recommend(<span class="number">222</span>,<span class="number">5</span>);</div><div class="line">            </div><div class="line">            <span class="keyword">for</span> (RecommendedItem recommendation : recommendations) &#123;</div><div class="line">              System.out.println(recommendation);</div><div class="line">            &#125;</div><div class="line">        &#125;   </div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>我们用到的4个类有DataModel, UserSimilarity, NearestNUserNeighborhood, Recommender。下面我们来逐个介绍一下这些类。</p>
<h2>DataModel</h2>
<p>DataModel是关于用户偏好信息的一个借口。实现这个接口的数据可以是任何来源（单独的条目，文件，数据库等等），但是大多数情况下数据都来源于数据库。使用时应当与<code>ReloadFromJDBCDataModel</code>类结合来获得更好的性能。举例来说，Mahout提供了<code>MySQLJDBCDataModel</code>来获得JDBC和MySQL数据库中的用户偏好信息。同时还有对PostgreSQL的支持。Mahout 同样提供了一个<code>FileDataModel</code>类，可以非常方便的应用于规模较小的项目中。
在该模型中，用户和物品都是用一个唯一的ID号来辨识，而且这个ID还必须是在Java中long类型的数字。而其中的<code>Preference</code>或者<code>PreferenceArray</code>对象者封装了用户和物品直接的关系（即物品，和用户对物品的喜爱度）。
最后，Mahout还有对布尔量数据模型的支持，该模型用户没有对某一物品进行特定的评分，而只是单纯的判断他们之间有没有建立某种联系。举例来说，某用户在一些电影推荐的网站上，可能可以对电影进行1~5星的评分。但是对于某个网站(比如说亚马逊)的推荐页，用户可能没有办法对这个推荐页的好坏进行评分，但是我们可以通过或缺用户是否访问了推荐的产品，即用户与推荐页是否建立了联系来建立DataModel。</p>
<p>Mahout0.9版本中Datamodel的类图（缩放页面查看大图）如下：
<img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/DataModelClassDiagram.png" alt="pic3"></p>
<h2>UserSimilarity&amp;&amp;ItemSimilarity</h2>
<p><code>UserSimilarity</code>定义了两个用户之间的相似度。只是推荐引擎的关键部分，也是目前推荐系统研究性能提高的关键点。这也是<code>Neighborhood</code>类寻找近邻的基础。<code>Neighborhood</code>也类似，是用来寻找物品之间的相似度。</p>
<p>Mahout0.9版本中相关的类图（缩放页面查看大图）如下：
<img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/Similarity.png" alt="pic4"></p>
<h2>UserNeighborhood</h2>
<p>在一个user-based 推荐系统中，相关的推荐是通过找到某一用户的相似用户，即“近邻”。
一个<code>UserNeighborhood</code>通过某种特定的手段得到一些邻近的用户，比如说最近的10用户、相似度大于0.8的用户。
通常UserNeighborhood的实现需要<code>UserSimilarity</code>作为入口。</p>
<p>Mahout0.9版本中相关的类图（缩放页面查看大图）如下：
<img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/UserNeiborhood.png" alt="pic5"></p>
<h2>Recommender</h2>
<p><code>Recommender</code>是Mahout核心的抽象类。对于一个DataModel,该类能够构造一个推荐器。项目中我们大部分情况下会用到
<code>GenericUserBasedRecommender</code> or <code>GenericItemBasedRecommender</code>来产生userbased以及Itembased 协同滤波推荐器，同时可能结合了 <code>CachingRecommender</code>。</p>
<p>Mahout0.9版本中相关的类图（缩放页面查看大图）如下：
<img src="/2014/08/01/RecSys/Mahout 推荐系统源码分析/Recommender.png" alt="pic6"></p>
<h2>结尾</h2>
<p>至此我们就介绍完了构造一个推荐系统所需要的一些类和接口，我们可以通过分析它更底层的代码，来进一步了解推荐系统实现的细节。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/12/alibaba/阿里大数据竞赛season1 总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/07/12/alibaba/阿里大数据竞赛season1 总结/" itemprop="url">阿里大数据竞赛season1 总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-07-12T20:12:22+08:00">
                2014-07-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/07/12/alibaba/阿里大数据竞赛season1 总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/07/12/alibaba/阿里大数据竞赛season1 总结/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h2>修订：</h2>
<ol>
<li>关于样本测试集和训练集数量上，一般是选择训练集数量不小于测试集，也就是说训练集选取6k可能还不够，大家可以多尝试得到更好的效果；</li>
<li>有人提出归一化方面可能有问题，大家可以查查其他的归一化方法，但是归一化环境是不可少的；</li>
<li>将部分代码传到了**<a href="https://github.com/armysheng/AliBigdataContestS1" target="_blank" rel="external">github</a>**</li>
<li>听说阿里又改赛制了，哈哈。</li>
</ol>
<hr>
<p>最近好累啊，简单总结一下吧。</p>
<h2>碎碎念</h2>
<p>这个比赛自己真的是花时间花精力去做了，虽然在s1止步，但是可以说对自己的数据分析入门算是蛮有意义的。收获的东西也蛮多，学了下python，真是一门灵活的语言（感谢o神的入门指南和规范易懂的代码，回头自己也得整理下代码，放到github上，其实之前在github上搜过，目测有10个左右的repository，==）；试着学习用了下git，每天提交的版本，不好好管理真的是会分不清最好成绩是那一版，git果然也是码农的神器；还接触了正则表达式（皮毛之皮毛），熟悉了sublime这款精美的编辑器，配上python简直高大上+爱不释手。算法方面，一开始面对这个题目，直接用了经验参数，8号的时候就到了6.8%，排名也蛮靠前，于是乎安安然，一直没去搞LR，cf等等算法，后来发现小伙伴们简直凶残，baseline 蹭蹭涨，排名蹭蹭往下掉。所以立马开始考虑转到LR，虽然之前也搞过一些分类问题，但是回头来看当时做的时候理解还是不够深的，这次索性从线性回归开始重新看了一遍Ng的视频，又加深了理解（但是还是喜欢直接调用，自己编的话太痛苦了吧），建立了逻辑回归模型，最后用纯LR线上到了6.5%吧，感觉还有提高的空间，但是调试的次数太少了。</p>
<h2>关于比赛</h2>
<p>大赛的赛题和数据在**<a href="http://102.alibaba.com/competition/addDiscovery/gameTopic.htm" target="_blank" rel="external">这里</a>**</p>
<p>关于比赛入门什么的就不应该提了，毕竟能进入s2的大牛应该占大多数。但是目测s2应该还有一些规则用户。我稍微结合自己对模式识别的理解，讲讲一些思路吧，希望能对小白有一点帮助，大牛可以无视了。
整个问题其实可以抽象成一个模式识别问题，对于任意的模式识别系统都可以套用如下的几个步骤：</p>
<pre><code>数据采集-&gt;预处理-&gt;特征提取-&gt;特征选择-&gt;分类器选择-&gt;分类器评价-&gt;再改进分类器
</code></pre>
<h3>数据采集</h3>
<p>这一步当然就不必说，阿里已经给了我们所有的数据</p>
<h3>预处理</h3>
<p>o神的第一发**<a href="http://oilbeater.com/2014/03/16/the-setup-of-bigdata-race/" target="_blank" rel="external">指南</a><strong>已经给出了明确的说明，如何数据处理成</strong>uid，bid，action_type,date** 其中date是离起始日4月15日的时差。然而模式识别中广义的预处理，除了将原始数据转换成可用的格式外，还包括数据清理，数据集成变换等等。比如说对于从未买过东西的Uid，从来没被买过的Bid直接删除（这对后面要说的正负样本采样很有意义），以及一些数据平滑，比如同一天点击数超过15就平滑为15，超过10次的购买平滑为10次。当然还有比较专业的平滑算法，如移动平滑，指数平滑。</p>
<h3>特征提取</h3>
<p>特征提取一般是整个系统的核心部分，好的特征是整个判别的关键，在图像处理领域，特征的提取一直是研究的热门。特征的提取一般是依靠个人的经验，这个例子中原始的点击数，购买数，搜藏数，以及加入购物车数，时间，很明显可以作为特征，但是单用这几个特征效果是不大好的。大家讨论的<strong>品牌热度，用户购买力,访问天数</strong>等等，都应该是不错的特征。这个阶段就需要靠你自己的购物体验，去提取出最好的特征。这样我们就可以得到一个如下的特征矩阵：</p>
<p>---uid bid  F1....Fn  Label----
12000  911 5   ...   0.8    0</p>
<p>同时，为了使各个特征的本身属性对分类的影响，比如说点击数一般都是一个很大的数，而某某率则是一个0~1之间的数，这样点击数肯定会对分类有更显著的影响，所以我们必须对特征进行归一化，我这里采用的是列模归一化，具体的做法就是每个值除以它所在列的平均值。</p>
<h3>特征选择</h3>
<p>特征是不是越多越好呢，这可不一定。特征数量较多，其中可能存在不相关的特征，特征之间也可能存在相互依赖，容易导致如下的后果：</p>
<p>Ø  特征个数越多，分析特征、训练模型所需的时间就越长。
Ø  特征个数越多，容易引起“维度灾难”，模型也会越复杂，其推广能力会下降。</p>
<p>S2里数据库更大，可玩性更高，估计大家要提前的特征也会更多，特征多的情况下，我们就要坐特征选择了。特征选择的意思就是通过算法能够得到前n个特征组合，使得分类器的error rate 最小，即这样组合最具有判别力。
一般特征选择是利用相关系数，好的特征子集所包含的特征应该是与分类的相关度较高（相关度高），而特征之间相关度较低的（亢余度低）。
可以使用线性相关系数(correlation coefficient) 来衡量向量之间线性相关度。</p>
<p><img src="/2014/07/12/alibaba/阿里大数据竞赛season1 总结/1.jpg.png" alt="Image Title"></p>
<p>还有之前论文中用到过的mutual information (MI) based method mRMR (minimal-Redundancy-Maximal-Relevance)，这个请参考【1】</p>
<h3>分类器构造</h3>
<p>首先在<strong>构建样本</strong>时，有个问题就是正负样本不平衡，常规的方法是重采用正样本，欠采样负样本。Bootstrap 采样是常用的重采样方法，简单的说就是又放回的抽样正样本。数据集第3月份的购买
数（即正样本）为215，我们可以通过放回的随机抽样出1k的正样本，未购买数由20000+条，我们可以无放回的随机抽样出5k条，当然正负样本比例1：5，1：10都可以构造。
构造完样本集，可以选择分类器了，貌似大部分选手都是选择的逻辑回归。逻辑回归的介绍请参见o神的**<a href="http://oilbeater.com/2014/04/04/the-bigdata-race-3/" target="_blank" rel="external">指南3</a>**，实现起来也是比较方便的，当然由于之前选择样本时随机性较大，一般会取1000次LR的结果取平均的参数来减少随机性的影响。
最后就是分类器的评价了，我的训练集选择前2月的行为特征和第三个月的购买(不是所有购买，前两个月有记录且购买)作为label，这样测试集就是前三个月的行为，以及第四个月的购买行为作为label。这样就可以不停的测试本地的分类效果。</p>
<p>最后说几点：</p>
<ul>
<li>模型融合会得到较好的效果，不要单纯的靠一种方法黑到底；</li>
<li>多种模型融合的时候，要注意这两种模型尽量不要在同一维度，这样会得到较好的效果</li>
<li>以上谈的数据集基本只能对出现过的历史行为做预测，对于没有出现的组合就无力了。如果要预测没有的组合就可以这样建矩阵：样本为所有 uid×bid,即摆出所有出现过的组合，特征还可以那样提，这样样本总数会变多，正样本数也会变多，对于未曾出现过的（uid，bid）组合其一些历史行为相关的特征可能为0，但是用户购买力，品牌热度的特征都是有的。所以也可以两类情况分开建模，没有试过，应该会有效果。当然cf之类的算法在预测未出现的组合上应该也会有不错的效果。排名靠前的港科同学们肯定也是发现了新组合这篇未开垦的处女地，预测数飙到270+。</li>
<li>LR的结果作为特征再次进行迭代LR会怎么样，没有试过。</li>
</ul>
<p>[1]	H. Peng, F. Long, and C. Ding, “Feature selection based on mutual information criteria of max-dependency, max-relevance, and min-redundancy,” Pattern Analysis and Machine Intelligence, IEEE Transactions on, vol. 27, no. 8, pp. 1226-1238, 2005.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/07/10/Data structure and Algorithms/DataStructure--链表问题总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/07/10/Data structure and Algorithms/DataStructure--链表问题总结/" itemprop="url">链表问题学习大总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-07-10T00:00:00+08:00">
                2014-07-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/07/10/Data structure and Algorithms/DataStructure--链表问题总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/07/10/Data structure and Algorithms/DataStructure--链表问题总结/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>链表问题学习大总结</h1>
<p><img src="/2014/07/10/Data structure and Algorithms/DataStructure--链表问题总结/linkedlist.jpg" alt="linkedlist">
链表问题各种被虐，基础非常不牢靠，所以要多花时间补基础，索性搜索一下链表问题做一个大总结。</p>
<h1>0. 链表的定义</h1>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> class <span class="title">Node</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> value;</div><div class="line">	Node next;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> value)</span></span>&#123;            </div><div class="line">		<span class="keyword">this</span>.value=value;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>1. 求链表的长度</h1>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//判断链表是否为空，如果空则没法赋值,同时不应该改动原来链表的头指针的指向,</span></div><div class="line"><span class="comment">//复杂度为O(n)</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getListLength</span><span class="params">(Node head)</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (head == <span class="keyword">null</span>)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">int</span> len=<span class="number">0</span>;</div><div class="line">	Node cur = head;</div><div class="line">	<span class="keyword">while</span>(cur!==<span class="keyword">null</span>)&#123;</div><div class="line">		len++;</div><div class="line">		cur=cur.next;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> len;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>2. 求单链表翻转</h1>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//  翻转链表（遍历）  </span></div><div class="line">   <span class="comment">// 从头到尾遍历原链表，每遍历一个结点，  </span></div><div class="line">   <span class="comment">// 将其摘下放在新链表的最前端。  </span></div><div class="line">   <span class="comment">// 注意链表为空和只有一个结点的情况。时间复杂度为O（n）</span></div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">reverse</span> <span class="params">(Node head)</span></span>&#123;</div><div class="line"></div><div class="line">	Node cur=head;</div><div class="line">	Node rehead=<span class="keyword">null</span>;</div><div class="line">	<span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next==<span class="keyword">null</span>) &#123;</div><div class="line">		<span class="keyword">return</span> head;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(cur!=<span class="keyword">null</span>)&#123;<span class="comment">//较难理解</span></div><div class="line">		Node temp = cur;</div><div class="line">		cur=cur.next;</div><div class="line">		temp.next = rehead;</div><div class="line">		rehead=	temp;		</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> rehead;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//翻转链表（递归）</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">reverse</span><span class="params">(Node head)</span></span>&#123;</div><div class="line">	Node rehead=<span class="keyword">null</span>;</div><div class="line">	<span class="keyword">if</span> (head==<span class="keyword">null</span>||head.next==<span class="keyword">null</span>) &#123;</div><div class="line">		<span class="keyword">return</span> head;			</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	Node rehead=reverse(head.next)</div><div class="line">	head.next.next=head;</div><div class="line">	head.next=<span class="keyword">null</span>;</div><div class="line">	<span class="keyword">return</span> rehead;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>3. 求倒数第K个点</h1>
<p><strong>题目描述</strong>：输入一个单向链表，输出该链表中倒数第k个节点，链表的倒数第0个节点为链表的尾指针。
分析：设置两个指针 p1、p2，首先 p1 和 p2 都指向 head，然后 p2 向前走 k 步，这样 p1 和 p2 之间就间隔 k 个节点，最后 p1 和 p2 同时向前移动，直至 p2 走到链表末尾。very tricky
<strong>代码如下</strong>：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">findBottomKth</span><span class="params">(Node head,<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">	Node slow = <span class="keyword">null</span>;</div><div class="line">	Node fast = <span class="keyword">null</span>;</div><div class="line">	slow=head;</div><div class="line">	fast=head;</div><div class="line">	<span class="keyword">int</span> i=k;</div><div class="line">	<span class="keyword">for</span> (;i&gt;<span class="number">0</span>&amp;&amp;fast!=<span class="keyword">null</span>;i--) &#123;</div><div class="line">		fast=fast.next;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(fast!=<span class="keyword">null</span>)&#123;</div><div class="line">		fast=fast.next;</div><div class="line">		slow=slow.next;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> slow;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>4. 查找链表中间的值</h1>
<pre><code>这题的方法思路和上一题一样，采用快慢两个指针，步长分别为1和2，遍历链表，直到快指针为null停止。
</code></pre>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">getListMid</span><span class="params">(Node head)</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (head==<span class="keyword">null</span>) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;			</div><div class="line">	&#125;</div><div class="line">	Node slow,fast;</div><div class="line">	slow=head;</div><div class="line">	fast=head;</div><div class="line">	<span class="keyword">while</span>(fast!=<span class="keyword">null</span>&amp;&amp;fast.next!=<span class="keyword">null</span>)&#123;</div><div class="line">		fast=fast.next();</div><div class="line">		<span class="keyword">if</span> (fast.next!=<span class="keyword">null</span>) &#123;</div><div class="line">			fast=fast.next				</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">return</span> slow;</div><div class="line">		slow=slow.next;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>5. 从尾到头打印链表</h1>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/** </span></div><div class="line">    * 从尾到头打印单链表 </div><div class="line">    * 对于这种颠倒顺序的问题，我们应该就会想到栈，后进先出。所以，这一题要么自己使用栈，要么让系统使用栈，也就是递归。注意链表为空的情况 </div><div class="line">    * 。时间复杂度为O（n） </div><div class="line">    */  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printReverseLink</span><span class="params">(Node head)</span></span>&#123;</div><div class="line">	Stack&lt;Node&gt; st =<span class="keyword">new</span> Stack&lt;Node&gt;();</div><div class="line">	<span class="keyword">if</span> (head==<span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">	Node cur = head;</div><div class="line">	<span class="keyword">while</span> (cur!=<span class="keyword">null</span>) &#123;</div><div class="line">		st.push(cur);</div><div class="line">		cur=cur.next;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (!s.empty()) &#123;</div><div class="line">		System.out.print(st.pop().vaule+<span class="string">" "</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** </span></div><div class="line">    * 使用递归 </div><div class="line">    */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printReverseLink</span><span class="params">(Node head)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> (head==<span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		Node cur = head;</div><div class="line">		printReverseLink(cur.next);</div><div class="line">		System.out.print(cur.vaule+<span class="string">" "</span>);		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>6. 判断链表是否有环，并找到环的入口</h1>
<p>题目描述：输入一个单向链表，判断链表是否有环。如果链表存在环，如何找到环的入口点？
解题思路： 由上题可知，按照 p2 每次两步，p1 每次一步的方式走，发现 p2 和 p1 重合，确定了单向链表有环路了。接下来，让p2回到链表的头部，重新走，每次步长不是走2了，而是走1，那么当 p1 和 p2 再次相遇的时候，就是环路的入口了。
为什么？：假定起点到环入口点的距离为 a，p1 和 p2 的相交点M与环入口点的距离为b，环路的周长为L，当 p1 和 p2 第一次相遇的时候，假定 p1 走了 n 步。那么有：
p1走的路径： <code>a+b ＝ n</code>；
p2走的路径： <code>a+b+k*L = 2*n</code>； p2 比 p1 多走了k圈环路，总路程是p1的2倍
根据上述公式可以得到 <code>k*L=a+b=n</code>显然，如果从相遇点M开始，p1 再走 n 步的话，还可以再回到相遇点，同时p2从头开始走的话，经过n步，也会达到相遇点M。
显然在这个步骤当中 p1 和 p2 只有前 a 步走的路径不同，所以当 p1 和 p2 再次重合的时候，必然是在链表的环路入口点上。
代码如下：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">findLoopPort</span><span class="params">(head)</span></span>&#123;</div><div class="line"></div><div class="line">	Node slow;</div><div class="line">	Node fast;</div><div class="line">	slow=head;</div><div class="line">	fast=head;</div><div class="line">	<span class="keyword">while</span>(fast!=<span class="keyword">null</span>&amp;&amp;fast.next!=<span class="keyword">null</span>)&#123;</div><div class="line">		slow=slow.next;</div><div class="line">		fast=fast.next.next;</div><div class="line">		<span class="keyword">if</span> (slow==fast) <span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (slow!=fast) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span>&#123;</div><div class="line">		fast=head;</div><div class="line">		<span class="keyword">while</span>(fast!=slow) &#123;</div><div class="line">			fast=fast.next;</div><div class="line">			slow=slow.next;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> slow;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>7.判断链表是否相交</h1>
<p>**题目描述：**给出两个单向链表的头指针（如下图所示），</p>
<p>比如h1、h2，判断这两个链表是否相交。这里为了简化问题，我们假设两个链表均不带环。
解题思路：
直接循环判断第一个链表的每个节点是否在第二个链表中。但，这种方法的时间复杂度为O(Length(h1) * Length(h2))。显然，我们得找到一种更为有效的方法，至少不能是O（N^2）的复杂度。
针对第一个链表直接构造hash表，然后查询hash表，判断第二个链表的每个节点是否在hash表出现，如果所有的第二个链表的节点都能在hash表中找到，即说明第二个链表与第一个链表有相同的节点。时间复杂度为为线性：O(Length(h1) + Length(h2))，同时为了存储第一个链表的所有节点，空间复杂度为O(Length(h1))。是否还有更好的方法呢，既能够以线性时间复杂度解决问题，又能减少存储空间？
转换为环的问题。把第二个链表接在第一个链表后面，如果得到的链表有环，则说明两个链表相交。如何判断有环的问题上面已经讨论过了，但这里有更简单的方法。因为如果有环，则第二个链表的表头一定也在环上，即第二个链表会构成一个循环链表，我们只需要遍历第二个链表，看是否会回到起始点就可以判断出来。这个方法的时间复杂度是线性的，空间是常熟。
进一步考虑“如果两个没有环的链表相交于某一节点，那么在这个节点之后的所有节点都是两个链表共有的”这个特点，我们可以知道，如果它们相交，则最后一个节点一定是共有的。而我们很容易能得到链表的最后一个节点，所以这成了我们简化解法的一个主要突破口。那么，我们只要判断两个链表的尾指针是否相等。相等，则链表相交；否则，链表不相交。
所以，先遍历第一个链表，记住最后一个节点。然后遍历第二个链表，到最后一个节点时和第一个链表的最后一个节点做比较，如果相同，则相交，否则，不相交。这样我们就得到了一个时间复杂度，它为O((Length(h1) + Length(h2))，而且只用了一个额外的指针来存储最后一个节点。这个方法时间复杂度为线性O(N)，空间复杂度为O(1)，显然比解法三更胜一筹。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isConnected</span><span class="params">(Node head1, Node head2)</span></span>&#123;</div><div class="line">	Node tail1 = head1;</div><div class="line">	Node tail2 =head2;</div><div class="line">	<span class="keyword">while</span>(tail1!=<span class="keyword">null</span>)</div><div class="line">		tail1=tail1.next;</div><div class="line">		<span class="keyword">while</span>(tail2!=<span class="keyword">null</span>)</div><div class="line">			tail2=tail2.next;</div><div class="line">		<span class="keyword">return</span> tail2==tail1;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>8.求两个单链表相交的第一个节点</h1>
<p>题目描述：如果两个无环单链表相交，怎么求出他们相交的第一个节点呢？
分析：采用对齐的思想。计算两个链表的长度 L1 , L2，分别用两个指针 p1 , p2 指向两个链表的头，然后将较长链表的 p1（假设为 p1）向后移动L2 - L1个节点，然后再同时向后移动p1 , p2，直到 p1 = p2。相遇的点就是相交的第一个节点。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">getFirstCommonNode</span><span class="params">(Node head1, Node head2)</span></span>&#123;</div><div class="line">	Node tail1 = head1;</div><div class="line">	Node tail2 =head2;</div><div class="line">	<span class="keyword">int</span> l1=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(tail1!=<span class="keyword">null</span>)<span class="comment">//list1 长度l1</span></div><div class="line">		&#123;	</div><div class="line">			tail1=tail1.next;</div><div class="line">			l1++;</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">int</span> l2=<span class="number">0</span>;</div><div class="line">		<span class="keyword">while</span>(tail2!=<span class="keyword">null</span>)<span class="comment">//list2 长度l2</span></div><div class="line">		&#123;</div><div class="line">			tail2=tail2.next;</div><div class="line">			l2++;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (tail1!=tail2) &#123;	<span class="comment">//如果不相等直接返回空，结束</span></div><div class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">		&#125;</div><div class="line">		tail1=head1;<span class="comment">//再回到头，长的链表先走|l1-l2|，再同步走直到相交</span></div><div class="line">		tail2=head2;</div><div class="line">		<span class="keyword">if</span> (l1&gt;l2) &#123;</div><div class="line">			<span class="keyword">int</span> k=l1-k2;</div><div class="line">			<span class="keyword">for</span>(;k!=<span class="number">0</span>;k--)</div><div class="line">				tail1=tail1.next;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			<span class="keyword">int</span> k=l2-l1;</div><div class="line">			<span class="keyword">for</span> (;k!=<span class="number">0</span>;k--) &#123;</div><div class="line">				tail2=tail2.next;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">while</span>(tail1!=tail2)&#123;</div><div class="line">			tail1=tail1.next;</div><div class="line">			tail2=tail2.next;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> tail1;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>9. 在O(1)时间删除链表节点</h1>
<p>**题目描述：**给定链表的头指针和一个节点指针，在O(1)时间删除该节点。[Google面试题]
分析：本题与《编程之美》上的「从无头单链表中删除节点」类似。主要思想都是「狸猫换太子」，即用下一个节点数据覆盖要删除的节点，然后删除下一个节点。但是如果节点是尾节点时，该方法就行不通了。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">	 <span class="comment">/** </span></div><div class="line">     * 给出一单链表头指针head和一节点指针toBeDeleted，O(1)时间复杂度删除节点tBeDeleted </div><div class="line">     * 对于删除节点，我们普通的思路就是让该节点的前一个节点指向该节点的下一个节点 </div><div class="line">     * ，这种情况需要遍历找到该节点的前一个节点，时间复杂度为O(n)。对于链表， </div><div class="line">     * 链表中的每个节点结构都是一样的，所以我们可以把该节点的下一个节点的数据复制到该节点 </div><div class="line">     * ，然后删除下一个节点即可。要注意最后一个节点的情况，这个时候只能用常见的方法来操作，先找到前一个节点，但总体的平均时间复杂度还是O(1) </div><div class="line">     */  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Node head, Node toDelete)</span></span>&#123;  </div><div class="line">        <span class="keyword">if</span>(toDelete == <span class="keyword">null</span>)&#123;  </div><div class="line">            <span class="keyword">return</span>;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">if</span>(toDelete.next != <span class="keyword">null</span>)&#123;          <span class="comment">// 要删除的是一个中间节点  </span></div><div class="line">            toDelete.val = toDelete.next.val;       <span class="comment">// 将下一个节点的数据复制到本节点!  </span></div><div class="line">            toDelete.next = toDelete.next.next;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">else</span>&#123;       <span class="comment">// 要删除的是最后一个节点！  </span></div><div class="line">            <span class="keyword">if</span>(head == toDelete)&#123;       <span class="comment">// 链表中只有一个节点的情况    </span></div><div class="line">                head = <span class="keyword">null</span>;  </div><div class="line">            &#125;<span class="keyword">else</span>&#123;  </div><div class="line">                Node node = head;  </div><div class="line">                <span class="keyword">while</span>(node.next != toDelete)&#123;   <span class="comment">// 找到倒数第二个节点  </span></div><div class="line">                    node = node.next;  </div><div class="line">                &#125;  </div><div class="line">                node.next = <span class="keyword">null</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;       </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1>10. 参考：</h1>
<p><a href="http://wuchong.me/blog/2014/03/25/interview-link-questions/" target="_blank" rel="external">面试精选：链表问题集锦</a>
<a href="http://blog.csdn.net/fightforyourdream/article/details/16353519" target="_blank" rel="external">面试大总结之一：Java搞定面试中的链表题目</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/06/05/Data structure and Algorithms/Little trick--字符串包含/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Eirc Sheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Eric's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/06/05/Data structure and Algorithms/Little trick--字符串包含/" itemprop="url">Leetcode刷题记--字符串包含</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-06-05T19:53:50+08:00">
                2014-06-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/06/05/Data structure and Algorithms/Little trick--字符串包含/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/06/05/Data structure and Algorithms/Little trick--字符串包含/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Little trick--字符串包含</h1>
<h2>题目描述</h2>
<p>给定两个分别由字母组成的字符串A和字符串B，字符串B的长度比字符串A短。请问，如何最快地判断字符串B中所有字母是否都在字符串A里？</p>
<p>为了简单起见，我们规定输入的字符串只包含大写英文字母，请实现函数bool StringContains(string &amp;A, string &amp;B)</p>
<p>比如，如果是下面两个字符串：</p>
<p>String 1：ABCD</p>
<p>String 2：BAD</p>
<p>答案是true，即String2里的字母在String1里也都有，或者说String2是String1的真子集。</p>
<p>如果是下面两个字符串：</p>
<p>String 1：ABCD</p>
<p>String 2：BCE</p>
<p>答案是false，因为字符串String2里的E字母不在字符串String1里。</p>
<p>同时，如果string1：ABCD，string 2：AA，同样返回true。</p>
<h2>分析与解法</h2>
<p>题目描述虽长，但题意很明了，就是给定一长一短的两个字符串A，B，假设A长B短，要求判断B是否包含在字符串A中。</p>
<p>初看似乎简单，但实现起来并不轻松，且如果面试官步步紧逼，一个一个否决你能想到的方法，要你给出更好、最好的方案时，恐怕就要伤不少脑筋了。</p>
<h2>解法一</h2>
<p>判断string2中的字符是否在string1中?最直观也是最简单的思路是，针对string2中每一个字符，逐个与string1中每个字符比较，看它是否在String1中。</p>
<p>代码可如下编写：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">stringContain</span><span class="params">(String S1,String S2)</span></span>&#123;      </div><div class="line">    <span class="keyword">char</span>[] S1Array=S1.toCharArray();</div><div class="line">    <span class="keyword">char</span>[] S2Array=S2.toCharArray();        </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;S2Array.length;i++)&#123;</div><div class="line">        <span class="keyword">int</span> j;</div><div class="line">        <span class="keyword">for</span> ( j=<span class="number">0</span>;j&lt;S1Array.length;j++)&#123;</div><div class="line">            <span class="keyword">if</span>(S2Array[i]==S1Array[j])&#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//如果内圈循环结束，判断是否遍历完了还是没有找到相等的</span></div><div class="line">        <span class="keyword">if</span> (j&gt;=S1Array.length)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>假设n是字符串String1的长度，m是字符串String2的长度，那么此算法，需要O(n*m)次操作。显然，时间开销太大，应该找到一种更好的办法。</p>
<h2>解法二</h2>
<p>如果允许排序的话，我们可以考虑下排序。比如可先对这两个字符串的字母进行排序，然后再同时对两个字串依次轮询。两个字串的排序需要(常规情况)O(m log m) + O(n log n)次操作，之后的线性扫描需要O(m+n)次操作。</p>
<p>关于排序方法，可采用最常用的快速排序，参考代码如下：
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//Version 2 排序后，使用连个指针指向长短两个string，进行遍历</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">stringContain2</span><span class="params">(String longstr, String shortstr)</span></span>&#123;</div><div class="line">    <span class="keyword">char</span>[] longstrArray=longstr.toCharArray();</div><div class="line">    <span class="keyword">char</span>[] shortstrArray=shortstr.toCharArray();</div><div class="line">    Arrays.sort(longstrArray);</div><div class="line">    Arrays.sort(shortstrArray);</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;<span class="comment">//point to longstr</span></div><div class="line">    <span class="keyword">int</span> j=<span class="number">0</span>;<span class="comment">//point ot shortstr</span></div><div class="line">    <span class="keyword">while</span>(j&lt;shortstrArray.length)&#123;</div><div class="line">        <span class="keyword">while</span>(i&lt;longstrArray.length&amp;&amp;shortstrArray[j]&gt;longstrArray[i])</div><div class="line">            i++;</div><div class="line">        <span class="keyword">if</span>(i&gt;=longstrArray.length)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        j++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2>解法三(tricky)</h2>
<p>有没有比快速排序更好的方法呢？</p>
<p>我们换一种角度思考本问题：</p>
<p>假设有一个仅由字母组成字串，让每个字母与一个素数对应，从2开始，往后类推，A对应2，B对应3，C对应5，......。遍历第一个字串，把每个字母对应素数相乘。最终会得到一个整数。</p>
<p>利用上面字母和素数的对应关系，对应第二个字符串中的字母，然后轮询，用每个字母对应的素数除前面得到的整数。如果结果有余数，说明结果为false。如果整个过程中没有余数，则说明第二个字符串是第一个的子集了（判断是不是真子集，可以比较两个字符串对应的素数乘积，若相等则不是真子集）。</p>
<p>思路总结如下：</p>
<ol>
<li>按照从小到大的顺序，用26个素数分别与字符'A'到'Z'一一对应。</li>
<li>遍历长字符串，求得每个字符对应素数的乘积。</li>
<li>遍历短字符串，判断乘积能否被短字符串中的字符对应的素数整除。</li>
<li>输出结果。
如前所述，算法的时间复杂度为O(m+n)的最好的情况为O(n)（遍历短的字符串的第一个数，与长字符串素数的乘积相除，即出现余数，便可退出程序，返回false），n为长字串的长度，空间复杂度为O(1)。由于这个方法太过机智，没有用java去实现，只是照搬了[1]中的C++代码.</li>
</ol>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//此方法只有理论意义，因为整数乘积很大，有溢出风险。</span></div><div class="line"><span class="function">bool <span class="title">StringContain</span><span class="params">(string &amp;a,string &amp;b)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> p[<span class="number">26</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>,<span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>&#125;;</div><div class="line">    <span class="keyword">int</span> f = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length(); ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> x = p[a[i] - <span class="string">'A'</span>];</div><div class="line">        <span class="keyword">if</span> (f % x)</div><div class="line">        &#123;</div><div class="line">            f *= x;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; b.length(); ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> x = p[b[i] - <span class="string">'A'</span>];</div><div class="line">        <span class="keyword">if</span> (f % x)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2>解法四(very tricky)</h2>
<p>如果面试官继续追问，还有没有更好的办法呢？计数排序？除了计数排序呢？</p>
<p>事实上，可以先把长字符串a中的所有字符都放入一个Hashtable里，然后轮询短字符串b，看短字符串b的每个字符是否都在Hashtable里，如果都存在，说明长字符串a包含短字符串b，否则，说明不包含。</p>
<p>再进一步，我们可以对字符串A，用位运算（26bit整数表示)计算出一个“签名”，再用B中的字符到A里面进行查找。
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"><span class="comment">//version 3 “最好的方法”，时间复杂度O(n + m)，空间复杂度O(1)</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">stringContain3</span><span class="params">(String longstr, String shortstr)</span></span>&#123;</div><div class="line">    <span class="keyword">char</span>[] longstrArray=longstr.toCharArray();</div><div class="line">    <span class="keyword">char</span>[] shortstrArray=shortstr.toCharArray();</div><div class="line">    <span class="keyword">int</span> hash = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;longstrArray.length;i++)&#123;</div><div class="line">        hash=hash|(<span class="number">1</span>&lt;&lt;(longstrArray[i]-<span class="string">'A'</span>));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;shortstrArray.length;j++)&#123;</div><div class="line">        <span class="keyword">if</span>((hash &amp; <span class="number">1</span>&lt;&lt;(shortstrArray[j]-<span class="string">'A'</span>))==<span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;               </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该方法将字符串转换成为二进制的位值表示，比如“ABCD”，通过第一个循环转换，按位或完之后成了0x0F,二进制表示的话是00001111，再用按位与的方式判断值是否为0，来进行判断是否存在，非常巧妙！这个方法的实质是用一个整数代替了hashtable，空间复杂度为O(1)，时间复杂度还是O(n + m)</p>
<h2>举一反三</h2>
<p>1、变位词</p>
<p>如果两个字符串的字符一样，但是顺序不一样，被认为是兄弟字符串，比如bad和adb即为兄弟字符串，现提供一个字符串，如何在字典中迅速找到它的兄弟字符串，请描述数据结构和查询过程。</p>
<h2>大部分参考了:</h2>
<p>[1] <a href="https://github.com/armysheng/The-Art-Of-Programming-By-July/blob/master/ebook/zh/01.02.md" target="_blank" rel="external">The-Art-Of-Programming-By-July chapter1.02</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Eirc Sheng" />
          <p class="site-author-name" itemprop="name">Eirc Sheng</p>
           
              <p class="site-description motion-element" itemprop="description">Nothing much yet</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">47</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/armysheng" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/armysheng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/armysheng" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/armysheng" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/armysheng" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-zhihu"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Eirc Sheng</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    

  




	





  





  





  






  





  

  

  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script>


  

</body>
</html>
